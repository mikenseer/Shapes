using UnityEngine;
using System.Collections;

public class BottomEdge : MonoBehaviour {

	public Variables vars;

	void Start(){
		GameObject v1 = GameObject.FindGameObjectWithTag ("Variables");
		vars = v1.GetComponent<Variables> ();
	
	}


	void OnTriggerEnter2D(Collider2D shape){

		CheckIfShape(shape);
						
		}

	void CheckIfShape(Collider2D shape){
		if (shape.tag == "Shape") {
			LoopThroughChildren(shape.gameObject);
								
			shape.gameObject.SetActive (false);
			vars.activeShapes--;
				}
		}
		
	void LoopThroughChildren(gameObject shape){
	
		foreach (Transform child in shape.transform) {
								
							DoThingsWithChildren(child.gameObject);
						}
	
	}
	void DoThingsWithChildren(gameObject shape){
	
		if (shape.renderer.enabled == false) {
			shape.renderer.enabled = true;
		} 
		else if (shape.tag == "Shape01" || shape.tag == "Shape02" || shape.tag == "Shape03" || shape.tag == "Shape04" || shape.tag == "Shape05") {
			
			ShapePassedPlater(shape.tag);

		}
	
	}
	void ShapePassedPlayer (string shape){
	
		if (vars.scoreMultiplier > 0 && vars.scoreMultiplier <= 10) {
					
				vars.shapesLetPast++;
				if (vars.powerCount == 0){
					
					vars.scoreMultiplier--;
					
				}
				
					vars.multiCount = 0;
			}
			else if (vars.scoreMultiplier > 10){
				vars.scoreMultiplier--;
				
			}
			else if (vars.scoreMultiplier <= 0) {
					//THIS IS GAME OVER
					vars.playerLives--;
					vars.shapesLetPast++;
			}
			if (vars.powerCount > 0){
				
				vars.powerCount--;
				
			}
	
	}

}
